@model ManufacturerDetailsView
@{
    ViewData["Title"] = "Details";
}

<style type="text/css">

    .custom-donut{
        top: -102px;
        width: 100%;
        position: absolute;
        z-index: 1;
        grid-column: col-start 9/span 4;
    }

    .donut-container{
        width: 159px;
        height: 159px;
        z-index: 1;
        margin: 0 auto;
        background: white;
        border-radius: 50%;
    }

    .confident-custom-Label{
        font-size: .6875rem;
        padding: 4px 8px;
        margin-right: 12px;
        line-height: 1;
        font-weight: 400;
    }
    
    .detailheaderSection{
        background-color: #f7fafd;
    }

    .howToFixLabel{
        font-size: .9375rem;
        line-height: 1.5rem;
        font-weight: 500;
        color: #1c1c21;
    }

    .grid-wrapper {        
        display: grid;
        grid-template-columns: repeat(12,[col-start] 1fr);
        position: relative;    
        padding-top: 2rem;
    }

    .subHeading{
        font-size: 1.125rem;
        line-height: 1.625rem;
        font-weight: 400;
        margin-top: 12px;
        margin-bottom: 48px;
        display: block;
    }

    ._detailsPageClass a {
        color: #4b45a1;
        text-decoration: none
    }

    .left{
        grid-column: col-start/span 7;
        grid-row: 1;
    }

    .right{
        grid-column: col-start 9/span 4;
        grid-row: 1;
        position: relative;
    }

    ._detailsPageClass a:hover {
        text-decoration: underline;
    }

    .angleRight{
        content: "›";
        margin: 0 8px 0 4px;
    }

    .angleIcon{
        font-size: 12px;
    }

    .defaultScrum{
        color: #555463;
    }

    .has-search .form-control {
        padding-left: 2.375rem;
    }

    .has-search .form-control-feedback {
        position: absolute;
        z-index: 2;
        display: block;
        width: 2.375rem;
        height: 2.375rem;
        line-height: 2.375rem;
        text-align: center;
        pointer-events: none;
        color: black;
    }

    ._detailsPageClass hr{
        opacity: unset;
        background-color: #d3d3d9;
        display: block;     
        margin: unset;
    }

    .info-block{
        font-size: 0.875rem;
        display: inline-block;
        font-weight: 500;
        margin-right: 12px;
    }

    .badgePill{
        background-color: #edecf6 !important;
        color: #4b45a1;
        font-size: .6875rem;
        padding: 4px 8px;
        margin-right: 12px;
        border: 1px solid #938fc7;
        line-height: 1;
        font-weight: 400;
    }

    .material-design-icon__svg {
        height: 1rem;
        width: 1rem;
        color: #938fc7;
    }

    .smallLink{
        font-size: 0.875rem;
    }

    .howToFixSection{
        padding: 1.6rem;
        background-color: #f6fafd;
        box-shadow: inset 0 0 0 1px #cce0f5, 0 0 0 2px transparent;
    }

    .cve-class{
        background-color: #fff;
        box-shadow: inset 0 0 0 1px #d3d3d9;
        padding: 72px 2rem 2rem 2rem;
    }

    .cve-class h3 {
        font-size: 1.125rem;
        line-height: 1.625rem;
    }

    .eachRow{
        padding-bottom: 2rem;
    }

    .Section-conatiner p {
        color: #555463;
    }

    .margin-bottom-one-rem{
        margin-bottom: 1rem;
    }

    .cve-items{
        display: flex;
        justify-content: space-between;
        padding: 1rem 0px;
    }

    .cve-itemName{
        font-size: 0.9375rem;
        font-family: sans-serif;
        color: rgb(85, 84, 99);
    }

    strong{
        font-weight: 500;
    }

    .donut-inside-item{
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        font-size: 45px;
        font-weight: 700;
        align-items: center;
        background-color: #fff;
        border-radius: 50%;
        box-shadow: 0 10px 15px rgba(79,75,147,.25);
        display: flex;
        justify-content: center;
        width: 120px;
        height: 120px;
        flex-direction: column;
    }

    .synk-cve-container{
        top: -50px;
        background-color: #fff;
        box-shadow: inset 0 0 0 1px #d3d3d9;
        padding: 72px 2rem 2rem 2rem;
    }

    .base-serverity-custom-label{
        padding: 7px 12px;
        font-size: .8125rem;
        line-height: 1;
        font-weight: 400;
    }

    @@media (min-width: 1400px) {
        .container {
            max-width: 100%;
        }
    }

    @@media (min-width: 720px){
        .cve-class{
            position: relative;
            top: -55px;
        }       
    }

    @@media (max-width: 720px){
        .custom-donut{
            grid-column: col-start/span 12;
            grid-row: 1;
            top: -106px;
        }

        .right{
            grid-column: col-start/span 12;
            grid-row: 2;
        }

        .left{
            grid-column: col-start/span 12;
            grid-row: 1;
        }

        .headingVal .left {
            margin-bottom: 44px;            
        }

        .mainContent .left{
            padding-top: 4rem;
        }

        .bread-crumb .right{
            padding-top: 2rem;
        }

        .mainContent .right{
            margin-top: 5rem;
        }

    }

</style>

<div class="_detailsPageClass">
    
    <div class="detailheaderSection">
        <div class="grid-wrapper bread-crumb site-layout-container">
            <div class="left">
                <a href="@Url.Action("","")">Snyk Vulnerability Database</a>
                <i class="fa fa-angle-right angleIcon" aria-hidden="true"></i>
                <a href="@Url.Action("List", "Home", new {id = Model?.manufacturerDetails?.manufacturerId})">@Model.manufacturerDetails.manufacturerName</a>
                <i class="fa fa-angle-right angleIcon" aria-hidden="true"></i>
                <span class="defaultScrum">@Model.manufacturerDetails.productName</span>
            </div>
            <div class="right">
                <div class="form-group has-search">
                    <span class="fa fa-search form-control-feedback"></span>
                    <input type="text" id="myInput" class="form-control inputBox" placeholder="Search">
                </div>
            </div>
        </div>
        <div class="grid-wrapper headingVal site-layout-container">
            <div class="left">
                <h2>
                    Denial of Service (DoS)
                    <span class="subHeading">Affecting @Model.manufacturerDetails.productName package, @Model.manufacturerDetails.versionNumber</span>
                </h2>
            </div>            
        </div>    
    </div>
    
    <hr class="@(Model.manufacturerDetails.baseSeverity == "HIGH" ? "high-custom-hr" : Model.manufacturerDetails.baseSeverity == "MEDIUM" ? "medium-custom-hr" : "")">
    <div class="grid-wrapper site-layout-container mainContent">
        <div class="custom-donut">
            <div class="donut-container">
                <canvas id="donutChart"></canvas>
            </div>
        </div>       
        <div class="right synk-cve-container">            
            <div class="pt-1">
                <input id="baseSeverity" value="@Model.manufacturerDetails.baseSeverity" hidden />
                <input id="impactScore" value="@Model.manufacturerDetails.impactScore" hidden />
                <h3 class="margin-bottom-one-rem"> Snyk CVSS </h3>
                <div class="cve-items">
                    <span class="cve-itemName">Attack Complexity</span>
                    <span class="cve-itemValue">
                        <strong>@Model.manufacturerDetails.accessComplexity</strong>
                        <span>
                            <svg fill="currentColor" width="24" height="24" viewBox="0 0 24 24" class="material-design-icon__svg">
                                <path d="M12 2a10 10 0 1 0 0 20 10 10 0 0 0 0-20zm1 17h-2v-2h2v2zm2.07-7.75l-.9.92A3.4 3.4 0 0 0 13 15h-2v-.5c0-1.1.45-2.1
                        1.17-2.83l1.24-1.26c.4-.33.6-.83.6-1.4a2 2 0 0 0-2-2 2 2 0 0 0-2 2H8c0-2.2 1.8-4 4-4s4 1.8
                        4 4c0 .9-.36 1.7-.93 2.27v-.03z">
                                </path>
                            </svg>
                        </span>
                    </span>
                </div>
                <div class="cve-items">
                    <span class="cve-itemName">Confidentiality</span>
                    <span class="cve-itemValue">
                        @if (Model.manufacturerDetails.confidentialityImpact == "Complete")
                        {
                            <span class="badge rounded-pill high-custom confident-custom-Label"> HIGH</span>
                        }
                        else if (Model.manufacturerDetails.confidentialityImpact == "Partial")
                        {
                            <span class="badge rounded-pill low-custom confident-custom-Label">LOW</span>
                        }
                        else
                        {
                            <strong>@Model.manufacturerDetails.confidentialityImpact</strong>
                        }


                        <span>
                            <svg fill="currentColor" width="24" height="24" viewBox="0 0 24 24" class="material-design-icon__svg">
                                <path d="M12 2a10 10 0 1 0 0 20 10 10 0 0 0 0-20zm1 17h-2v-2h2v2zm2.07-7.75l-.9.92A3.4 3.4 0 0 0 13 15h-2v-.5c0-1.1.45-2.1
                                    1.17-2.83l1.24-1.26c.4-.33.6-.83.6-1.4a2 2 0 0 0-2-2 2 2 0 0 0-2 2H8c0-2.2 1.8-4 4-4s4 1.8
                                    4 4c0 .9-.36 1.7-.93 2.27v-.03z">
                                </path>
                            </svg>
                        </span>
                    </span>
                </div>
                <div class="collapse" id="collapseExample">                   
                    <div class="cve-items">
                        <span class="cve-itemName">Attack Vector</span>
                        <span class="cve-itemValue">
                            <strong>@Model.manufacturerDetails.accessVector</strong>
                            <span>
                                <svg fill="currentColor" width="24" height="24" viewBox="0 0 24 24" class="material-design-icon__svg">
                                    <path d="M12 2a10 10 0 1 0 0 20 10 10 0 0 0 0-20zm1 17h-2v-2h2v2zm2.07-7.75l-.9.92A3.4 3.4 0 0 0 13 15h-2v-.5c0-1.1.45-2.1
                                        1.17-2.83l1.24-1.26c.4-.33.6-.83.6-1.4a2 2 0 0 0-2-2 2 2 0 0 0-2 2H8c0-2.2 1.8-4 4-4s4 1.8
                                        4 4c0 .9-.36 1.7-.93 2.27v-.03z">
                                    </path>
                                </svg>
                            </span>
                        </span>
                    </div>
                    <div class="cve-items">
                        <span class="cve-itemName">Privileges Required</span>
                        <span class="cve-itemValue">
                            @if(Model.manufacturerDetails.obtainAllPrivilege)
                            {
                                <span class="badge rounded-pill high-custom confident-custom-Label"> HIGH</span>
                            }
                            else if (Model.manufacturerDetails.obtainUserPrivilege)
                            {
                                <span class="badge rounded-pill medium-custom confident-custom-Label"> MEDIUM</span>
                            }
                            else if (Model.manufacturerDetails.obtainOtherPrivilege)
                            {
                                <span class="badge rounded-pill low-custom confident-custom-Label"> LOW</span>
                            }
                            else
                            {
                                <strong>None</strong>
                            }
                            
                            <span>
                                <svg fill="currentColor" width="24" height="24" viewBox="0 0 24 24" class="material-design-icon__svg">
                                    <path d="M12 2a10 10 0 1 0 0 20 10 10 0 0 0 0-20zm1 17h-2v-2h2v2zm2.07-7.75l-.9.92A3.4 3.4 0 0 0 13 15h-2v-.5c0-1.1.45-2.1
                                        1.17-2.83l1.24-1.26c.4-.33.6-.83.6-1.4a2 2 0 0 0-2-2 2 2 0 0 0-2 2H8c0-2.2 1.8-4 4-4s4 1.8
                                        4 4c0 .9-.36 1.7-.93 2.27v-.03z">
                                    </path>
                                </svg>
                            </span>
                        </span>
                    </div>
                    <div class="cve-items">
                        <span class="cve-itemName">User Interaction</span>
                        <span class="cve-itemValue">
                            @if (Model.manufacturerDetails.userInteractionRequired)
                            {
                                <strong>Required</strong>
                            }
                            else
                            {
                                <strong>None</strong>
                            }                            
                            <span>
                                <svg fill="currentColor" width="24" height="24" viewBox="0 0 24 24" class="material-design-icon__svg">
                                    <path d="M12 2a10 10 0 1 0 0 20 10 10 0 0 0 0-20zm1 17h-2v-2h2v2zm2.07-7.75l-.9.92A3.4 3.4 0 0 0 13 15h-2v-.5c0-1.1.45-2.1
                                        1.17-2.83l1.24-1.26c.4-.33.6-.83.6-1.4a2 2 0 0 0-2-2 2 2 0 0 0-2 2H8c0-2.2 1.8-4 4-4s4 1.8
                                        4 4c0 .9-.36 1.7-.93 2.27v-.03z">
                                    </path>
                                </svg>
                            </span>
                        </span>
                    </div>
                    <div class="cve-items">
                        <span class="cve-itemName">Scope</span>
                        <span class="cve-itemValue">
                            <strong>None</strong>
                            <span>
                                <svg fill="currentColor" width="24" height="24" viewBox="0 0 24 24" class="material-design-icon__svg">
                                    <path d="M12 2a10 10 0 1 0 0 20 10 10 0 0 0 0-20zm1 17h-2v-2h2v2zm2.07-7.75l-.9.92A3.4 3.4 0 0 0 13 15h-2v-.5c0-1.1.45-2.1
                                        1.17-2.83l1.24-1.26c.4-.33.6-.83.6-1.4a2 2 0 0 0-2-2 2 2 0 0 0-2 2H8c0-2.2 1.8-4 4-4s4 1.8
                                        4 4c0 .9-.36 1.7-.93 2.27v-.03z">
                                    </path>
                                </svg>
                            </span>
                        </span>
                    </div>
                    <div class="cve-items">
                        <span class="cve-itemName">Integrity</span>
                        <span class="cve-itemValue">
                           @* @if (Model.manufacturerDetails.integrityImpact == "Complete")
                            {
                                <span class="badge rounded-pill high-custom confident-custom-Label"> HIGH</span>
                            }
                            else if (Model.manufacturerDetails.integrityImpact == "Partial")
                            {
                                <span class="badge rounded-pill low-custom confident-custom-Label">LOW</span>
                            }
                            else
                            {*@
                                <strong>@Model.manufacturerDetails.integrityImpact</strong>
                            @*}*@
                            <span>
                                <svg fill="currentColor" width="24" height="24" viewBox="0 0 24 24" class="material-design-icon__svg">
                                    <path d="M12 2a10 10 0 1 0 0 20 10 10 0 0 0 0-20zm1 17h-2v-2h2v2zm2.07-7.75l-.9.92A3.4 3.4 0 0 0 13 15h-2v-.5c0-1.1.45-2.1
                                        1.17-2.83l1.24-1.26c.4-.33.6-.83.6-1.4a2 2 0 0 0-2-2 2 2 0 0 0-2 2H8c0-2.2 1.8-4 4-4s4 1.8
                                        4 4c0 .9-.36 1.7-.93 2.27v-.03z">
                                    </path>
                                </svg>
                            </span>
                        </span>
                    </div>
                    <div class="cve-items">
                        <span class="cve-itemName">Availability</span>
                        <span class="cve-itemValue">
                            @if (Model.manufacturerDetails.availabilityImpact == "Complete")
                            {
                                <span class="badge rounded-pill high-custom confident-custom-Label"> HIGH</span>
                            }
                            else if (Model.manufacturerDetails.availabilityImpact == "Partial")
                            {
                                <span class="badge rounded-pill low-custom confident-custom-Label">LOW</span>
                            }
                            else
                            {
                                <strong>@Model.manufacturerDetails.availabilityImpact</strong>
                            }
                            <span>
                                <svg fill="currentColor" width="24" height="24" viewBox="0 0 24 24" class="material-design-icon__svg">
                                    <path d="M12 2a10 10 0 1 0 0 20 10 10 0 0 0 0-20zm1 17h-2v-2h2v2zm2.07-7.75l-.9.92A3.4 3.4 0 0 0 13 15h-2v-.5c0-1.1.45-2.1
                                        1.17-2.83l1.24-1.26c.4-.33.6-.83.6-1.4a2 2 0 0 0-2-2 2 2 0 0 0-2 2H8c0-2.2 1.8-4 4-4s4 1.8
                                        4 4c0 .9-.36 1.7-.93 2.27v-.03z">
                                    </path>
                                </svg>
                            </span>
                        </span>
                    </div>
                </div>
                <p class="ml-3 mt-3">
                    <a data-bs-toggle="collapse" href="#collapseExample" role="button"
                        id="btnToggle"
                        onclick="filterToggle()" aria-expanded="false" aria-controls="collapseExample">See More</a>
                </p>
            </div>            
        </div>
        <div class="left">
            <div class="eachRow">
                <span class="info-block">INTRODUCED: @Model.manufacturerDetails.published.ToString("dd MMM yyyy").ToUpper()</span>
                <span class="badge rounded-pill bg-primary badgePill">New</span>
                <a href="https://www.cve.org/CVERecord?id=@Model.manufacturerDetails.cveId" target="_blank" class="smallLink">@Model.manufacturerDetails.cveId</a>
                <span>
                    <svg fill="currentColor" width="24" height="24" viewBox="0 0 24 24" class="material-design-icon__svg">
                        <path d="M12 2a10 10 0 1 0 0 20 10 10 0 0 0 0-20zm1 17h-2v-2h2v2zm2.07-7.75l-.9.92A3.4 3.4 0 0 0 13 15h-2v-.5c0-1.1.45-2.1
                            1.17-2.83l1.24-1.26c.4-.33.6-.83.6-1.4a2 2 0 0 0-2-2 2 2 0 0 0-2 2H8c0-2.2 1.8-4 4-4s4 1.8
                            4 4c0 .9-.36 1.7-.93 2.27v-.03z">
                        </path>
                    </svg>
                </span>
            </div>
            <div class="howToFixSection mb-4">
                <div class="pb-2"><span class="howToFixLabel">How to fix?</span></div>
                <span class="defaultScrum">There is no fixed version for @Model.manufacturerDetails.productName.</span>
            </div>
            <div class="pb-2"><span class="howToFixLabel">Overview</span></div>
            <div class="overViewDesc pb-3">
                <p>@Model.manufacturerDetails.value</p>
            </div>
            @* <div class="pb-2"><span class="howToFixLabel">Details</span></div>
            <p>
            Denial of Service (DoS) describes a family of attacks, all aimed at making a system inaccessible to its intended and legitimate users.
            </p>

            <p>
            Unlike other vulnerabilities, DoS attacks usually do not aim at breaching security. Rather,
            they are focused on making websites and services unavailable to genuine users resulting in downtime.
            </p>

            <p>
            One popular Denial of Service vulnerability is DDoS (a Distributed Denial of Service), an attack that attempts
            to clog network pipes to the system by generating a large volume of traffic from many machines.
            </p>

            <p>
            When it comes to open source libraries, DoS vulnerabilities allow attackers to trigger such a crash or crippling
            of the service by using a flaw either in the application code or from the use of open source libraries.
            </p>

            <p>    Two common types of DoS vulnerabilities: </p>
            <ul>
            <li>
            <p>High CPU/Memory Consumption- An attacker sending crafted requests that could cause the system to take a disproportionate amount of time to process. For example, <a href="SNYK-JAVA-COMMONSFILEUPLOAD-30082">commons-fileupload:commons-fileupload</a>.</p>
            </li>
            <li>
            <p>Crash - An attacker sending crafted requests that could cause the system to crash. For Example,  <a href="https://snyk.io/vuln/npm:ws:20171108">npm <code>ws</code> package</a></p>
            </li>
            </ul>*@

            <div class="pb-2"><span class="howToFixLabel">References</span></div>
            <ul>
                <li><a href="https://github.com/lloyd/yajl/issues/250">GitHub Issue</a></li>
            </ul>
        </div>

    </div>
</div>

@section Scripts {
    <script>
        $(document).ready(function () {
            InitDonutChart();

            $('#myInput').keypress(function (event) {
                if (event.keyCode === 13) {
                    myFunction();
                }
            });

            function myFunction() {
                // Code to execute when Enter is pressed
                const searchedValue = $('#myInput').val();
                window.location.href = '/Home/List?Search=' + searchedValue;
            }
        });

        function InitDonutChart(){
            var ctx = document.getElementById('donutChart').getContext('2d');
            var percentValue = $('#impactScore').val();
            var baseSeverityValue = $('#baseSeverity').val();
            var cssForSer = '';
            var chartColor = '';

            if (baseSeverityValue == 'HIGH'){
                cssForSer = 'high-custom';
                chartColor = '#ad1a1a'
            }
            else if (baseSeverityValue == 'MEDIUM'){
                cssForSer = 'medium-custom';
                chartColor = "#d68100"
            }


            var donutChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    datasets: [{
                        data: [10 - percentValue, percentValue],
                        backgroundColor: [                            
                            'rgba(255, 255, 255, 0.0)', // Color for the unfilled portion (transparent)
                            chartColor // Color for the filled portion
                        ],
                        borderWidth: 0
                    }]
                },                
                options: {                    
                    cutout: 49,
                    legend: {
                        display: false
                    },
                    tooltips: {
                        enabled: false
                    },
                }
            });

            // Display the percentage value in the center of the donut chart
            donutChart.canvas.parentNode.style.position = 'relative';
            donutChart.canvas.style.position = "absolute";
            donutChart.canvas.style.top = "-6px";            
            var percentageDiv = document.createElement('div');
            percentageDiv.className = "donut-inside-item " + cssForSer;
            percentageDiv.innerHTML = '<div style="top: -5px; position:relative;">' + Number(percentValue) + '</div><span style="top: -5px; position:relative;" class="badge rounded-pill ' + cssForSer + ' base-serverity-custom-label">' + baseSeverityValue + '</span>';
            donutChart.canvas.parentNode.appendChild(percentageDiv);

        }

        function filterToggle(){
            var val = $('#btnToggle').text();
            if (val !== 'See Less') {
                $('#btnToggle').text('See Less');
            } else {
                $('#btnToggle').text('See More');
            }
        }

    </script>
}



